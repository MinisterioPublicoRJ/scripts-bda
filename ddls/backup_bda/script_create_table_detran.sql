CREATE TABLE tb_regcivil(  base varchar(50),   nu_rg varchar(50),   dt_expedicao_carteira timestamp,   no_cidadao varchar(255),   no_paicidadao varchar(255),   no_maecidadao varchar(255),   naturalidade varchar(100),   dt_nascimento timestamp,   documento_origem varchar(255),   nu_cpf varchar(11),   endereco varchar(255),   bairro varchar(255),   municipio varchar(255),   uf varchar(2),   cep varchar(8))PARTITIONED BY (   year int) STORED AS PARQUET;
CREATE VIEW vw_regcivil AS SELECT orig.* FROM detran.tb_regcivil orig INNER JOIN (SELECT nu_rg, max(dt_expedicao_carteira) ultima_expedicao FROM detran.tb_regcivil GROUP BY nu_rg) sub ON orig.nu_rg = sub.nu_rg AND orig.dt_expedicao_carteira = sub.ultima_expedicao ORDER BY year DESC
